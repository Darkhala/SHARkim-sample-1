<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/images/icon logo.png">
  <title>Sharkim Traders</title>
  <meta name="google-site-verification" content="uxPP5lqdUTZHzt7bdvb35EFmGSualVMqV1GpBFpaQXc" />
  <meta name="description" content="Shop quality home appliances and electronics at Sharkim Traders. Great prices, fast support, and reliable delivery.">
  <link rel="canonical" href="/index.html">
  <meta property="og:title" content="Sharkim Traders">
  <meta property="og:description" content="Shop quality home appliances and electronics at Sharkim Traders.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/images/sharkim_gold_logo.png">
  <meta property="og:url" content="/index.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Sharkim Traders">
  <meta name="twitter:description" content="Shop quality home appliances and electronics at Sharkim Traders.">
  <meta name="twitter:image" content="/images/sharkim_gold_logo.png">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Sharkim Traders",
    "url": "/index.html",
    "logo": "/images/sharkim_gold_logo.png",
    "contactPoint": [{
      "@type": "ContactPoint",
      "telephone": "+254704843554",
      "contactType": "customer service",
      "areaServed": "KE"
    }]
  }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <style>
    html, body { max-width: 100%; overflow-x: hidden; }
    body { font-family: "Times New Roman", Times, serif, Arial, Helvetica, sans-serif; }
    img, svg { max-width: 100%; height: auto; }
    .brand-gold { color: #ac8334; }
  </style>
  
</head>
<body class="bg-gray-100">

<!-- TOP CONTACT BAR -->
<div class="w-full bg-black text-gray-200 text-xs">
  <div class="max-w-7xl mx-auto px-3 py-2 flex items-center justify-between">
    <!-- Left now minimal/help -->
    <div class="flex items-center gap-4">

    </div>
    <!-- Right shows contact info (swapped sides) -->
    <div class="flex items-center gap-4">
      <a href="https://wa.me/254704843554" class="flex items-center gap-1 hover:text-yellow-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 32 32" fill="currentColor"><path d="M16 .5C7.6.5.5 7.6.5 16c0 2.8.7 5.5 2.2 7.9L0 32l8.3-2.7c2.3 1.3 5 2 7.7 2 8.4 0 15.5-7.1 15.5-15.5S24.4.5 16 .5zM16 29c-2.4 0-4.8-.6-6.9-1.8l-.5-.3-4.9 1.6 1.6-4.8-.3-.5C3.6 21 3 18.6 3 16 3 9.4 9.4 3 16 3s13 6.4 13 13-6.4 13-13 13zm7.3-9.8c-.4-.2-2.3-1.1-2.6-1.2s-.6-.2-.8.2c-.2.4-1 1.2-1.2 1.4s-.4.3-.8.1c-.4-.2-1.6-.6-3-2-1.1-1.1-1.9-2.3-2.1-2.7s0-.6.2-.8.4-.4.6-.6c.2-.2.3-.4.4-.6.1-.2 0-.5 0-.7s-.8-2-1.1-2.8c-.3-.8-.6-.7-.8-.7h-.7c-.2 0-.7.1-1.1.5s-1.4 1.4-1.4 3.4 1.4 3.9 1.6 4.1c.2.2 2.7 4.2 6.5 5.9.9.4 1.7.7 2.2.9.9.3 1.6.3 2.2.2.7-.1 2.3-1 2.6-1.9.3-.9.3-1.7.2-1.9-.1-.2-.3-.3-.7-.5z"/></svg>
        +254 704 843 554
      </a>
      <a href="mailto:sharkimtraders97@gmail.com" class="hover:text-yellow-400">sharkimtraders97@gmail.com</a>
    </div>
  </div>
</div>

<!-- MAIN HEADER: logo top, search center, nav under -->
<header class="bg-black text-white py-5">
  <div class="max-w-7xl mx-auto px-3">
    <!-- Logo top -->
    <div class="flex flex-col items-start">
      <img src="images/sharkim_gold_logo.png" alt="Sharkim Logo" class="h-20">
      <div class="text-xs brand-gold mt-1">usted ordena, entregamos</div>
    </div>

    <!-- Search row + Cart on right (swapped from left) -->
    <div class="mt-4 w-full flex flex-wrap items-center gap-2">
      <input type="text" id="searchInput" placeholder="Search products..." class="min-w-0 flex-1 px-4 py-2 text-black border rounded focus:outline-none">
      <button id="searchBtn" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">Search</button>
      <button id="cartBtn" class="ml-auto flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded hover:bg-red-700">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 4h-2l-1 2H1v2h2l3.6 7.6-1.4 2.4c-.2.3-.2.8 0 1.2.2.4.6.6 1 .6h12v-2H7.4c-.1 0-.2 0-.2-.1l.9-1.5h7.9c.4 0 .7-.2.9-.5l3.6-6.5c.2-.4.1-.8 0-1.1-.2-.3-.5-.5-.9-.5H6.2L5.3 4H7zm0 16c-1.1 0-2 .9-2 2s.9 2 2 2c1.2 0 2-.9 2-2s-.8-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2c1.2 0 2-.9 2-2s-.9-2-2-2z"/></svg>
        Cart
        <span id="cartCount" class="bg-yellow-400 text-black text-xs font-bold px-2 py-0.5 rounded-full">0</span>
      </button>
    </div>

    <!-- Centered Nav with icons just below search -->
    <nav class="mt-3">
      <ul class="flex flex-wrap justify-center gap-4 md:gap-6 text-sm">
        <li>
          <a href="index.html" class="flex items-center gap-2 hover:text-yellow-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3l9-8z"/></svg>
            Home
          </a>
        </li>
        <li>
          <a href="shop.html" class="flex items-center gap-2 hover:text-yellow-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M7 4h-2l-1 2H1v2h2l3.6 7.6-1.4 2.4c-.2.3-.2.8 0 1.2.2.4.6.6 1 .6h12v-2H7.4c-.1 0-.2 0-.2-.1l.9-1.5h7.9c.4 0 .7-.2.9-.5l3.6-6.5c.2-.4.1-.8 0-1.1-.2-.3-.5-.5-.9-.5H6.2L5.3 4H7z"/></svg>
            Shop
          </a>
        </li>
        <li>
          <a href="about.html" class="flex items-center gap-2 hover:text-yellow-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            About
          </a>
        </li>
        <li>
          <a href="faq.html" class="flex items-center gap-2 hover:text-yellow-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm1 15h-2v-2h2v2zm2.07-7.75c-.9.65-1.07 1.09-1.07 1.75h-2c0-1.6 1.04-2.45 1.86-3.03.74-.51 1.14-.85 1.14-1.47 0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5H9c0-1.93 1.57-3.5 3.5-3.5S16 4.57 16 6.5c0 1.55-1.15 2.3-1.93 2.75z"/></svg>
            FAQ
          </a>
        </li>
        <li>
          <a href="contact.html" class="flex items-center gap-2 hover:text-yellow-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M21 8V7l-3 2-2-1-4 2-4-2-4 2v10h20V8zM5 17v-6l3-1.5 4 2 4-2 3 1.5V17H5zm7-11l4 2 5-3-9-4-9 4 5 3 4-2z"/></svg>
            Contact
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>

<!-- HERO + CATEGORY SIDEBAR -->
<section class="w-full py-4 bg-white">
  <div class="max-w-7xl mx-auto px-3 grid grid-cols-1 md:grid-cols-12 gap-4">
  <!-- Left: Categories list -->
  <aside class="hidden md:block md:col-span-3 bg-white rounded shadow p-3 h-fit">
    <h3 class="font-semibold mb-2">Shop Categories</h3>
    <ul id="leftCatList" class="space-y-1 text-sm"></ul>
  </aside>
  <!-- Mobile: Categories dropdown -->
  <div class="md:hidden">
    <button id="mobileCatToggle" class="w-full flex items-center justify-between px-3 py-2 bg-white rounded shadow">
      <span class="font-semibold">Shop by Categories</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
    </button>
    <div id="mobileCatPanel" class="mt-2 bg-white rounded shadow p-3 hidden">
      <ul id="mobileCatList" class="space-y-1 text-sm"></ul>
    </div>
  </div>
  <!-- Right: Banner -->
  <div class="md:col-span-9 relative rounded overflow-hidden bg-white">
    <!-- Semi-transparent dark overlay above the image to enhance text legibility -->
    <img src="/images/Banner.png" class="w-full h-64 md:h-72 object-cover block" alt="banner">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="absolute inset-0 flex flex-col items-start justify-center p-4 md:p-6" style="color:#ffffff !important;">
      <h2 class="text-2xl md:text-3xl font-bold drop-shadow" style="color:#ffffff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.35);">Home Appliances Electronics</h2>
      <p style="color:#ffffff !important;">Shop now & save up to 40%</p>
      <a href="shop.html" class="mt-3 inline-block px-5 py-2 bg-red-600 rounded">Shop Now</a>
    </div>
  </div>
  </div>
</section>

<!-- MAIN PRODUCT SECTIONS -->
<main class="max-w-7xl mx-auto px-3 py-6 space-y-12" id="mainContent"></main>

<!-- Email Overlay -->
<div id="emailOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
  <div class="bg-white p-6 rounded-lg w-96 shadow-lg">
    <h2 class="text-lg font-bold mb-4">Send Email Inquiry</h2>
    <form id="emailForm" class="space-y-3">
      <input type="hidden" id="productInfo">
      <div>
        <label class="block text-sm">Name:</label>
        <input type="text" id="name" class="w-full border px-3 py-2 rounded" required>
      </div>
      <div>
        <label class="block text-sm">Phone Number:</label>
        <input type="text" id="phone" class="w-full border px-3 py-2 rounded" required>
      </div>
      <div>
        <label class="block text-sm">Location:</label>
        <input type="text" id="location" class="w-full border px-3 py-2 rounded" required>
      </div>
      <div>
        <label class="block text-sm">Message:</label>
        <textarea id="message" class="w-full border px-3 py-2 rounded" rows="4" readonly></textarea>
      </div>
      <div class="flex justify-between mt-4">
        <button type="button" id="cancelEmail" class="px-4 py-2 bg-gray-400 text-white rounded">Cancel</button>
        <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded">Send</button>
      </div>
    </form>
  </div>
</div>

<!-- Footer Section -->
<footer class="bg-black text-gray-200 mt-10">
  <div class="max-w-7xl mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-4 gap-8">
    <div>
      <img src="images/sharkim_gold_logo.png" alt="Company Logo" class="h-14 mb-4">
      <p class="mb-2">WhatsApp Us: <a href="https://wa.me/254704843554" class="text-[#ac8334] font-medium">+254 704 843 554</a></p>
      <p class="mb-2">Call Us: <a href="tel:+254704843554" class="text-white font-medium">+254 704 843 554</a></p>
      <p class="mb-2">Email Us: <a href="mailto:sharkimtraders97@gmail.com" class="text-[#ac8334] font-medium">sharkimtraders97@gmail.com</a></p>
      <p class="text-sm text-gray-400">Time: 8:30AM - 6:30PM</p>
    </div>
    <div>
      <h3 class="text-lg font-semibold mb-3 text-white">Quick Links</h3>
      <ul class="space-y-2">
        <li><a href="index.html" class="hover:text-[#ac8334]">Home</a></li>
        <li><a href="shop.html" class="hover:text-[#ac8334]">Shop</a></li>
        <li><a href="about.html" class="hover:text-[#ac8334]">About Us</a></li>
        <li><a href="faq.html" class="hover:text-[#ac8334]">FAQ</a></li>
        <li><a href="contact.html" class="hover:text-[#ac8334]">Contact</a></li>
      </ul>
    </div>
    <div>
      <h3 class="text-lg font-semibold mb-3 text-white">Working Hours</h3>
      <p class="mb-1">Monday - Saturday: <span class="font-medium">08:30 - 18:30</span></p>
      <p class="mb-1">Sunday: <span class="text-red-500">Closed</span></p>
    </div>
    <div>
      <h3 class="text-lg font-semibold mb-3 text-white">Payments</h3>
      <div class="flex space-x-3">
        <img src="/images/mpesa1.png" alt="MPESA" class="h-6">
      </div>
    </div>
  </div>
  <div class="bg-black text-[#ac8334] text-center py-3 mt-6">
    <p class="text-sm">&copy; 2025 Sharkim Traders. All rights reserved.</p>
  </div>
</footer>

<script type="module" src="js/auth.js"></script>
<script src="js/categories.js"></script>
<script>
// =====================
// CONFIG & SUPABASE
// =====================
const SUPABASE_URL = 'https://evmiakneqtoxvnzeiwlz.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV2bWlha25lcXRveHZuemVpd2x6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzMTU4NTEsImV4cCI6MjA2OTg5MTg1MX0.lgW9OGAg8etuIzWPs-t0Ek_P7y3_m5GEo-ZSzbqbsGc';
const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// =====================
// ELEMENTS
// =====================
const mainContent = document.getElementById('mainContent');
const leftCatList = document.getElementById('leftCatList');
const searchInput = document.getElementById('searchInput');
const emailOverlay = document.getElementById('emailOverlay');
const emailForm = document.getElementById('emailForm');
const cartBtn = document.getElementById('cartBtn');
const cartCountBadge = document.getElementById('cartCount');
const mobileCatList = document.getElementById('mobileCatList');
const mobileCatToggle = document.getElementById('mobileCatToggle');
const mobileCatPanel = document.getElementById('mobileCatPanel');

// =====================
// CART (localStorage)
// =====================
let cart = JSON.parse(localStorage.getItem('cart') || '[]');
function saveCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }
function updateCartCount(){ if (cartCountBadge) cartCountBadge.innerText = cart.length; }
updateCartCount();

(function ensureCartDrawer(){
  if (document.getElementById('cartDrawer')) return;
  const drawer = document.createElement('div');
  drawer.id = 'cartDrawer';
  drawer.className = 'fixed top-0 right-0 w-80 max-w-full h-full bg-white shadow-lg p-4 hidden z-50';
  drawer.innerHTML = `
    <h2 class="text-lg font-bold mb-4">Your Cart</h2>
    <div id="cartItems" class="space-y-3"></div>
    <div class="mt-4 border-t pt-3">
      <p class="font-bold">Total: Ksh <span id="cartTotal">0</span></p>
      <div class="flex gap-2 mt-3">
        <button id="cartWhatsApp" class="bg-green-600 text-white px-3 py-2 rounded w-1/2">WhatsApp</button>
        <button id="cartEmail" class="bg-blue-600 text-white px-3 py-2 rounded w-1/2">Email</button>
      </div>
    </div>
    <button id="cartClose" class="absolute top-2 right-2 text-gray-500">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  `;
  document.body.appendChild(drawer);
  document.getElementById('cartClose').onclick = closeCart;
  document.getElementById('cartWhatsApp').onclick = checkoutWhatsApp;
  document.getElementById('cartEmail').onclick = checkoutEmail;
})();

function openCart(){ renderCart(); document.getElementById('cartDrawer').classList.remove('hidden'); }
function closeCart(){ document.getElementById('cartDrawer').classList.add('hidden'); }
function renderCart(){
  const wrap = document.getElementById('cartItems');
  const totalEl = document.getElementById('cartTotal');
  wrap.innerHTML = '';
  let total = 0;
  if (cart.length === 0) { wrap.innerHTML = "<p class='text-gray-500'>Your cart is empty</p>"; totalEl.innerText = 0; return; }
  cart.forEach((item, idx) => {
    total += Number(item.price) || 0;
    const row = document.createElement('div');
    row.className = 'flex gap-2 items-center border-b pb-2';
    row.innerHTML = `
      <img src="${item.image_url}" alt="${item.title}" class="w-12 h-12 object-contain">
      <div class="flex-1">
        <p class="font-bold text-sm">${item.title}</p>
        <p class="text-xs text-gray-600">Ksh ${item.price}</p>
      </div>
      <button class="text-red-600" aria-label="Remove">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M10 7V5a2 2 0 114 0v2" />
        </svg>
      </button>
    `;
    row.querySelector('button').onclick = () => { cart.splice(idx, 1); saveCart(); updateCartCount(); renderCart(); };
    wrap.appendChild(row);
  });
  totalEl.innerText = total;
}

function checkoutWhatsApp(){
  if (cart.length === 0) return alert('Your cart is empty!');
  let msg = '🛒 *New Order from Sharkim Traders*\n\n';
  let total = 0; cart.forEach((item, i) => { msg += `${i+1}. ${item.title} - Ksh ${item.price}\n`; total += Number(item.price)||0; });
  msg += `\n----------------------\n💰 *Total:* Ksh ${total}\n\n`;
  msg += '📍 Please confirm delivery details.';
  window.open(`https://wa.me/+254704843554?text=${encodeURIComponent(msg)}`, '_blank');
}
function checkoutEmail(){
  if (cart.length === 0) return alert('Your cart is empty!');
  let subject = '🛒 New Cart Order - Sharkim Traders';
  let body = 'Hello Sharkim Traders,\n\nI\'d like to order the following products:\n\n';
  let total = 0; cart.forEach((item, i) => { body += `${i+1}. ${item.title} - Ksh ${item.price}\n`; total += Number(item.price)||0; });
  body += `\n----------------------\nTotal: Ksh ${total}\n\n`;
  body += 'Customer details:\nName: __________\nPhone: __________\nLocation: __________';
  window.location.href = `mailto:sharkimtraders97@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
}
if (cartBtn) cartBtn.onclick = openCart;

// =====================
// PRODUCTS (HOME SECTIONS)
// =====================
let allProducts = [];

function buildLeftCategories(){
  if (leftCatList) leftCatList.innerHTML = '';
  if (mobileCatList) mobileCatList.innerHTML = '';
  (window.MAIN_CATEGORIES || []).forEach(cat => {
    const li = document.createElement('li');
    li.innerHTML = `<a class="block px-2 py-1 rounded hover:bg-gray-100" href="shop.html?main=${encodeURIComponent(cat)}">${cat}</a>`;
    if (leftCatList) leftCatList.appendChild(li.cloneNode(true));
    if (mobileCatList) mobileCatList.appendChild(li);
  });
}

async function fetchProducts(){
  const { data, error } = await client.from('Products').select('*');
  if (error) { console.error('❌ Error fetching products:', error); return; }
  allProducts = (data||[]).map(p => ({
    ...p,
    // Ensure we use new schema: category (main), sub_category (sub), description separate
    category: p.category || p.main_category || 'Uncategorized',
    sub_category: p.sub_category || p.subcategory || '',
    description: p.description || ''
  }));
  buildLeftCategories();
  buildHomeSections(allProducts);
}

function buildHomeSections(products){
  // group by category
  const map = new Map();
  products.forEach(p => {
    const mc = p.category || 'Uncategorized';
    if (!map.has(mc)) map.set(mc, []);
    map.get(mc).push(p);
  });
  const cats = Array.from(map.keys()).sort();
  mainContent.innerHTML = '';
  cats.forEach(cat => {
    const list = map.get(cat).slice();
    list.sort(() => Math.random() - 0.5);
    const sample = list.slice(0, 6);
    const section = document.createElement('section');
    section.className = 'space-y-3';
    section.innerHTML = `
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold">${cat}</h2>
        <a href="shop.html?main=${encodeURIComponent(cat)}" class="text-blue-600 hover:underline">See more</a>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4" data-cat="${cat}"></div>
    `;
    mainContent.appendChild(section);
    const container = section.querySelector('[data-cat]');
    sample.forEach(p => container.appendChild(renderCard(p)));
  });
}

function renderCard(product){
  const disc = (product.original_price && product.original_price>0)
    ? Math.round(((product.original_price - product.price)/product.original_price)*100) : 0;
  const el = document.createElement('div');
  el.className = 'bg-white p-3 rounded shadow text-center';
  el.innerHTML = `
    <a href="product.html?id=${encodeURIComponent(product.id)}" class="block">
      <img src="${product.image_url}" alt="${product.title}" class="h-32 mx-auto object-contain mb-2">
      <h3 class="text-sm font-bold line-clamp-2">${product.title}</h3>
    </a>
    <p class="text-xs line-through text-gray-500">${product.original_price ? 'Ksh ' + product.original_price : ''}</p>
    <p class="text-red-600 font-bold">Ksh ${product.price}</p>
    ${disc?`<span class="bg-red-600 text-white text-xs px-2 py-1 rounded inline-block mt-1">${disc}% OFF</span>`:''}
    <div class="mt-3 flex justify-center gap-2">
      <a href="https://wa.me/+254704843554?text=${encodeURIComponent('I want ' + product.title)}" target="_blank" class="flex items-center gap-1 px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 32 32" fill="currentColor"><path d="M16 .5C7.6.5.5 7.6.5 16c0 2.8.7 5.5 2.2 7.9L0 32l8.3-2.7c2.3 1.3 5 2 7.7 2 8.4 0 15.5-7.1 15.5-15.5S24.4.5 16 .5zM16 29c-2.4 0-4.8-.6-6.9-1.8l-.5-.3-4.9 1.6 1.6-4.8-.3-.5C3.6 21 3 18.6 3 16 3 9.4 9.4 3 16 3s13 6.4 13 13-6.4 13-13 13zm7.3-9.8c-.4-.2-2.3-1.1-2.6-1.2s-.6-.2-.8.2c-.2.4-1 1.2-1.2 1.4s-.4.3-.8.1c-.4-.2-1.6-.6-3-2-1.1-1.1-1.9-2.3-2.1-2.7s0-.6.2-.8.4-.4.6-.6c.2-.2.3-.4.4-.6.1-.2 0-.5 0-.7s-.8-2-1.1-2.8c-.3-.8-.6-.7-.8-.7h-.7c-.2 0-.7.1-1.1.5s-1.4 1.4-1.4 3.4 1.4 3.9 1.6 4.1c.2.2 2.7 4.2 6.5 5.9.9.4 1.7.7 2.2.9.9.3 1.6.3 2.2.2.7-.1 2.3-1 2.6-1.9.3-.9.3-1.7.2-1.9-.1-.2-.3-.3-.7-.5z"/></svg>
        WhatsApp
      </a>
      <button class="flex items-center gap-1 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600" data-email>
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2zm8 7 8-5H4l8 5zm0 2-8-5v10h16V8l-8 5z"/></svg>
        Email
      </button>
    </div>
  `;
  el.querySelector('[data-email]').onclick = () => openEmailForm(product.title);
  return el;
}

function openEmailForm(productTitle){
  emailOverlay.classList.remove('hidden');
  const message = `I want ${productTitle}`;
  document.getElementById('productInfo').value = productTitle;
  document.getElementById('message').value = message;
}

document.getElementById('cancelEmail').onclick = function(){ emailOverlay.classList.add('hidden'); };

document.getElementById('emailForm').onsubmit = function(e){
  e.preventDefault();
  const name = document.getElementById('name').value;
  const phone = document.getElementById('phone').value;
  const location = document.getElementById('location').value;
  const product = document.getElementById('productInfo').value;
  const emailMessage = document.getElementById('message').value;
  const body = `Product: ${product}%0AName: ${name}%0APhone: ${phone}%0ALocation: ${location}%0AMessage: ${emailMessage}`;
  window.location.href = `mailto:sharkimtraders97@gmail.com?subject=Product Inquiry&body=${body}`;
  emailOverlay.classList.add('hidden');
};

// Search -> redirect to shop
if (document.getElementById('searchBtn')){
  document.getElementById('searchBtn').addEventListener('click', () => {
    const q = (searchInput.value || '').trim();
    window.location.href = `shop.html?q=${encodeURIComponent(q)}`;
  });
  searchInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') document.getElementById('searchBtn').click();
  });
}

// Mobile categories toggle
if (mobileCatToggle && mobileCatPanel){
  mobileCatToggle.addEventListener('click', () => mobileCatPanel.classList.toggle('hidden'));
}

fetchProducts();
</script>
<script src="js/theme.js"></script>
</body>
</html>